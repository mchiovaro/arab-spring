---
title             : "Online Social Cohesion Reflects Real-World Group Action in Syria during the Arab Spring"
shorttitle        : "Arab Spring"

author:
  - name          : "Megan Chiovaro"
    affiliation   : "1, 2"
    corresponding : yes    # Define only one corresponding author
    address       : "406 Babbidge Road, Unit 1020, Storrs, CT 06269"
    email         : "megan.chiovaro@uconn.edu"
  - name          : "Alexandra Paxton"
    affiliation   : "1,2,*"
  - name          : "Leah C. Windsor"
    affiliation   : "3,*"

affiliation:
  - id            : "1"
    institution   : "Center for the Ecological Study of Perception and Action, University of Connecticut"
  - id            : "2"
    institution   : "Department of Psychological Sciences, University of Connecticut"
  - id            : "3"
    institution   : "University of Memphis"
  - id            : "*"
    institution   : "Equal author contributions"

abstract: |
  Social mobilization requires effective collective coordination. In recent 
  years, individuals involved in social movements have taken to social media
  platforms to reach broader audiences at rapid speeds. Effective virtual 
  mobilization similarly requires social cohesion and coordination, yet the 
  degree to which virtual mobilization reflects or drives real-world movements
  is unclear. Here, we explore the dynamics of real-world events and social 
  cohesion on Twitter in Syria during the Arab Spring. Using the nonlinear 
  methods cross-recurrence quantification analysis and windowed cross-recurrence
  quantification analysis, we investigate if counts of all daily events, daily 
  positive events, and daily negative events are coupled with social cohesion 
  found in Syrian tweets. Results indicate that virtual social cohesion is 
  coupled with the counts of all and negative events each day but not with 
  counts of positive events. This suggests that virtual mobilization does reflect 
  real-world movements but only for salient, frequent and negative events. We 
  conclude with a discussion of implications and applications of nonlinear 
  methods in political science research.
  <!-- https://tinyurl.com/ybremelq -->

keywords          : "social cohesion, recurrence quantification analysis, complex systems, Twitter, Arab Spring"
wordcount         : "X"

bibliography      : ["references.bib"]

floatsintext      : no
figurelist        : no
tablelist         : no
footnotelist      : no
linenumbers       : yes
mask              : no
draft             : no
appendix          : 

documentclass     : "apa6"
classoption       : "man"
header-includes   :
  - "\\usepackage{float}"
output            : papaja::apa6_pdf
---

```{r setup, include = FALSE}

# clear the workspace
rm(list=ls())

# install and load required packages
source('./scripts/required_packages.r')
source('./scripts/libraries_and_functions.r')

# turn on caching
knitr::opts_chunk$set(cache=TRUE, autodep=TRUE, cache.lazy=FALSE)

# create subdirectories
dir.create("./data/raw") # load three data files here
dir.create("./data/formatted/primary", recursive = TRUE)
dir.create("./data/formatted/secondary/icews", recursive = TRUE)
dir.create("./data/formatted/secondary/phoenix", recursive = TRUE)
dir.create("./results/primary/crqa", recursive = TRUE)
dir.create("./results/primary/windowed-crqa", recursive = TRUE)
dir.create("./results/secondary/icews/crqa", recursive = TRUE)
dir.create("./results/secondary/icews/windowed-crqa", recursive = TRUE)
dir.create("./results/secondary/phoenix/crqa", recursive = TRUE)
dir.create("./results/secondary/phoenix/windowed-crqa", recursive = TRUE)

```

```{r data-prep, echo=FALSE, warning=FALSE, message=FALSE, error=FALSE, results='hide'}

# format the data
source('./scripts/primary-analyses/01_formatting_data.R')
source('./scripts/secondary-analyses/icews/01_formatting_data.R')
source('./scripts/secondary-analyses/phoenix/01_formatting_data.R')

```

Social coordination has long been used both physically and virtually
to start and carry out collective actions. These collective events
bring individuals together and create emergent patterns of communication
and action. Online communication has historically been used to document
and communicate archival information about events, but it has been
increasingly used to bring about social change. From a dynamical
systems perspective, these different means of social coordination during
times of turmoil can be considered two complementary components of a
single system, mutually constrained and constantly interacting and
influencing one another [@mahner1997foundations]. Investigation of the
coupling of real-world mobilization and social cohesion could provide
new insight into the power of social media during mobilization and the
ways in which individuals utilize it to bring about, or respond to, social
change. Increasingly, social media platforms are being utilized during
social mobilization, but the relationship between virtual and real-world
mobilization is still largely unknown. The present work aims to understand
how physical and virtual movements coexist and interact from a dynamical
systems perspective.

## Arab Spring
In December 2010, a Tunisian man named Mohamed Bouazizi was harassed and
unjustifiably stripped of his vendor cart by municipal officials. His
humiliation led him to set himself on fire in protest to the authoritarian
rule, ultimately leading to his death several days later. His actions served
as a catalyst for the Tunisian Revolution, and one week after his death,
Zine El Abidine Ben Ali---the longstanding authoritarian president---fled the
country. The events of Tunisia rapidly spread to surrounding countries 
also subject to unjust authoritarian rule, including Yemen, Egypt, Libya,
and Syria. 

These mass movements would not have been possible without
efficient large-scale coordination, both physically on the ground and virtually 
on social media platforms. Along with Facebook, Twitter has been credited as 
essential to the Arab Spring---both for protesters (as a means to coordinate 
with one another and to communicate with the world) and for the government 
response (to monitor and track protestors to crack down on dissent) 
[@comninos2011twitter]. The events of Arab Spring have been thoroughly 
discussed within the political science literature 
[e.g., @lutterbeck2013arab; @koehler2017political], but to our knowledge,
the direct *coupling* between Syrian Twitter cohesion and international action
coordination has not been investigated.

## Social Cohesion and Social Mobilization
Real-world collective action is known to bring about a sense of togetherness,
also known as “collective effervescence” [@durkheim1995elementary]. This
feeling of being a part of something larger than oneself leads individuals
to act in ways that would not have on their own. Being overcome with this
feeling can lead to violence [@collins2009violence; @spaaij2014sports].
Conversely, increased exposure
to violence can result in positive social cohesion. @gilligan2014civil
found that exposure to fatal wartime violence resulted in increased prosocial
motivations, including cooperative behaviors, feelings of trust, and overall
community-level social cohesion. 

Just as real-world social cohesion can be
quantified, so can online cohesion. While this can be quantified in many ways,
one kind of cohesion can be found in the similarity in language use on social media.
This implicit or explicit similarity in language use can indicate shared
beliefs, thoughts, and feelings, as has been studied in research on language style
in psycholinguistics and social psychology 
[@gonzales2010language; @tausczik2010psychological; @brennan1996conceptual]; 
although previous work on language style
has often focused on individuals and small groups, this can be scaled up to examine
massive social-level changes [@michel2011quantitative; @fusaroli2015timescales]. 
This kind of widespread online social cohesion can lead to real-world
social change.

Combining these separate threads, it is reasonable to expect that real-world actions 
and online social interactions would be enmeshed, driving and being driven by 
one another. Rather than expecting that only real-world social cohesion would be
driven by real-world action, we would expect interaction between real-world and
virtual dynamics: In this case, exposure to real-world violence could result in social
cohesion in the virtual world. Increased social cohesion is thus potentially
an indicator and a result of increased social organization and mobilization 
on the ground. 

Social media platforms provide one way to enable this kind of online social
cohesion by offering distributed information-gathering and real-time information
dissemination. Given its accessibility and proficiency as an information
exchange tool, Twitter has provided individuals involved in social movements
an opportunity to complement or even replace real-world social mobilization.
For example, during the 2012 Italian protests for global economic change, the riots in
Rome were mirrored by Twitter activity both on the day of the protests and in the
days following them [@vicari2013public]. Tweeting was
determined to be more effective locally in discussing real-world, real-time
events than traditional mainstream media platforms. As more and more
individuals rely on social media to obtain local news and information, it
becomes increasingly important to understand just how these micro-blogs
reflect real-world action.

## Using Nonlinear Methods to Capture Complex Relationships
Given the hypothesized interrelationship between the real-world
and online actions---and the notorious messiness of naturally occurring
data---it is critical to find appropriate analysis tools that can
identify the complex interconnections. Traditional linear analyses have led to 
many notable discoveries in the domains of psychology and political science, 
but time series data pose problems that are not easily overcome with these 
methods. Events have historically been conceptualized as linear chains of 
smaller, sequential events with one occurrence leading to the next. 
Certain kinds of data are relatively well-suited to these analyses,
but messy, complex, variable data from real-world events can pose
challenges, from overpowered samples to violation of underlying
statistical assumptions [@paxton2017finding].

At the same time, the foundational theoretical assumptions of a 
linear world has been
increasingly replaced by ideas from dynamical systems theory. Rather than
a chain of events, time series data can be thought of as nested occurrences,
where mutually constrained parts (e.g., citizens, governments, real-world
events, social media platforms) are constantly interacting, leading to
more global behaviors that are larger than the sum of the parts
[@turvey2018lectures]. Linear analyses flatten time series data and ignore 
the variability that is fundamental to these systems and their evolution over 
time. However, when analyzed as dynamical systems, many phenomena
exhibit new nonlinear patterns that were formerly overlooked. 
Nonlinear methods provide means for capturing the rich temporal
dynamics and variability that unfold in time series data.

Although a number of other nonlinear methods exist, 
the primary nonlinear method used in the current work is cross-recurrence
quantification analysis [CRQA; @zbilut1998detecting] and its offshoot,
windowed cross-recurrence quantification analysis [WCRQA; @webber2005recurrence].
CRQA has successfully been used to gain a better understanding of many
complex human phenomena, including a variety of human social interactions
[for a review, see @fusaroli2014analyzing]. 
Much as it has for psychology, we argue that the use of nonlinear methods in
the investigation of political science phenomena will lead to new insights
and the development of more robust theories.

## The Present Work
Social media has become a primary platform for social movements and
activism across the world, but the extent to which virtual activism
reflects and drives real-world mobilization is still largely unknown. 
In the current work, we
conceptualize the physical and virtual movements as a dynamical system,
both constantly interacting and influencing the other. We aim to study
this by analyzing the real-world events and online social cohesion
during nearly three months of the Arab Spring. Both real- and
virtual-world collective coordination were powerful tools in the events
of the Arab Spring and are undeniably linked. This study aims to explore
the dynamics of Syrian Twitter users, who used the social media platform to raise
awareness about the Arab Spring and bring about mass mobilization.

Using cross-recurrence quantification analysis [CRQA; @zbilut1998detecting]
and windowed cross-recurrence quantification analysis
[WCRQA; @webber2005recurrence], we analyzed the co-evolution of social
cohesion online and real-world events. Specifically, using heterogeneous
data from March 30, 2012, to June 15, 2012, we compared the social cohesion
of Syrian tweets with the counts
of all, positive, and negative real-world events derived from gold-standard
international event data [i.e., the Integrated Crisis Early Warning
System; @DVN/28075_2015].

We hypothesized that the count of all events and the count of negative
events would show high levels of determinism, as this time period was
marked by daily violence which often leads to increased salience. We also
hypothesized that the count of positive events would not show patterns of
determinism, as these events were likely overshadowed by the salient
negative daily occurrences. 
After testing these hypotheses, we then conducted exploratory analyses 
to further examine the patterns identified with CRQA. Using WCRQA,
we sought to identify shifts in the
dynamics of the systems that could then be linked to real-world shifts in
conflict frequency.
Through these analyses, our two primary goals in the current work were to uncover
(1) how different intensities during times of turmoil may enhance or deter
social cohesion in social media communication and (2) how social mobilization
may be evident in the dynamic coupling of cohesion and real-world events.

An additional focus of the current work is to introduce cross-recurrence
quantification analysis---a longstanding method from physics that has 
since become influential in a variety of other fields---to political 
science. We do so by providing detailed descriptions of the methods and
providing clear directions about interpretation and significance testing
even with relatively small-*n* or case studies. After demonstrating these
methods' utility with this dataset, we close the paper with specific
suggestions to political scientists interested in incorporating these
methods into their work.

# Method
## Materials
### Tweet Corpus

```{r tweet-count, echo=FALSE, warning=FALSE, message=FALSE, error=FALSE, results='hide'}

# read in social cohesion data
cohesion_df <- read.csv("./data/raw/Syria-social_cohesion.csv")

```

The corpus of tweets used included `r sum(cohesion_df$n)` Syrian tweets
occurring between March 30--June 15, 2012. Using the Twitter
streaming API, servers at the University of Texas at Austin collected
the tweets. The servers were run on a stable (LTS) version of Ubuntu
Linus (v. 10.04) and were connected directly to the high-bandwidth UT network
maintained by IT services.

Tweets collected contained one or more of the following keywords:
“syria,” “syrian,” “damascus,” “homs,” “al-assad,” and “sunni.” These
keywords were chosen based on the most distinctive terms used in news
articles covering the Arab Spring in Syria at the time. A node.js script
was used to reinitialize the connection to Twitter's servers whenever the
script timed out due to a period of silence. The script requested data from
the API endpoint using basic HTTP authentication (OAuth was optional, at
the time) at https://stream.twitter.com/1.1/statuses/filter.json, and stored
the data directly to the local hard disk. The tweets were then post-processed
with a Python script to convert the JSON-formatted tweets to tab-separated
files, which were then compressed to maximize storage efficiency.

All scripts used for scrapping tweets and compressing data can be found at https://github.com/chbrown/twilight.

### Event Data
Event data were obtained from the 2012 Integrated Crisis Early Warning
System [ICEWS; @DVN/28075_2015]. The event data were first filtered to
remove incomplete and incorrectly formatted data. They were then filtered
to include only events that were directed at (i.e., `target`) Syria ($n = 6300$).
To explore the impact of outwardly directed Syrian events, the data were
filtered again to include events that were both directed at (i.e., `target`)
or directed by (i.e., `source`) Syria ($n = 7990$).

## Data Preparation
### Social Cohesion Metric
The social cohesion or linguistic similarity of daily tweets was calculated
by quantifying the frequency of shared content words with respect to those
words’ frequencies in the entire tweet corpus. If a linguistic term has a
high frequency in one tweet but has a low frequency in the whole tweet
corpus, then it is more likely a content word and is thus given more weight
in calculating social cohesion. 
This method is similar to inverse document frequency (IDF).
For more information on IDF, see @jones1972statistical and
@robertson2004understanding.

The tweets were first sorted into ascending order by timestamp. They were
then grouped into successive sets of five tweets. Inverse frequency
weighting for the overlap words and all words was conducted for each pair
of two tweets in the group of five, then divided to get the social cohesion
score for that pair (see Eq. 1-3). This resulted in ten social cohesion
values for each group of five tweets; these values were then averaged to get
a social cohesion score for the entire set of five tweets. Finally,
the mean of all average cohesion values for all groups was taken to get
a social cohesion score for each day.

\begin{align}
\text{Inverse frequency weighting of overlap words = }\sum_{i=1}^k \frac{log(f(t_i, d1) + f(t_i, d2) + 1)}{log(f(t_i) + 1)}
\end{align}

\begin{align}
\text{Inverse frequency weighting of all words = }\sum_{i=1}^n \frac{log(f(t_i, d1) + f(t_i, d2) + 1)}{log(f(t_i) + 1)}
\end{align}

\begin{align}
\text{Two tweets similarity =}\frac{\text{inverse frequency weighting of overlap words}}{\text{inverse frequency weighting of all words}}
\end{align}

The social cohesion calculation was performed on the tweet corpus
containing both English and Arabic tweets. All hashtags and URLs were included 
in the analysis.

### ICEWS Event Time Series
Using the Integrated Crisis Early Warning System (ICEWS) developed at the
Defense Advanced Research Project Agency, the daily events were
scored with an intensity rating ranging from -10 to 10. Negative 
events---such as riots and attacks---are coded with low negative numbers, while
positive or peaceful events are coded with high positive numbers. This
well-validated coding scheme allows for numerical quantification of
different event types.

For both the target only and the target and source data described above, time series of
the count of all events were generated by summing the total number of events
on each day, irrespective of ICEWS score. Similarly, time series of count
of positive events were generated by summing the number of ICEWS events
for each day that had an intensity rating greater than zero. Lastly,
time series of count of negative events were generated by summing the number
of ICEWS events for each day that had an intensity rating less than zero.

## Analyses
### Cross-Recurrence Quantification Analysis
We first used cross-recurrence quantification analysis
[CRQA; @zbilut1998detecting] to investigate the temporal patterns of
social cohesion and real-world events in Syria during Arab Spring. CRQA
is an extension of RQA, which captures the patterns of revisited states of
a single time series [@zbilut1992embeddings; @webber1994dynamical]. CRQA
allows for two time series to be projected onto one another to investigate
shared states and trajectories.
In CRQA, we track these shared states by identifying *recurrent points*,
or intersections of time during which two signals shared or revisited the same
state. These shared states can be at the same time or at later points in
the time series. We can further chart shared trajectories by examining
the occurrences and patterns of multiple sequential recurrent points.

To perform CRQA, the time series must be converted to the same
scale, while still preserving a sampling rate that respects the native
timescale of the system
[cf. Nyquist frequency in signal processing; @grenander1959probability].
Because the social cohesion and event data have different scales and values,
we converted each time series (e.g., Figure \@ref(fig:raw-ts)) into deciles
(e.g., Figure \@ref(fig:deciled-ts)) to analyze the relative dynamics of different
levels of social cohesion and counts of all, positive, and negative events
on each day. 
We implemented CRQA using the `crqa` package [@R-crqa] for R [@R-base]. 

#### Visualization
A cross-recurrence plot (CRP) is the visual representation of CRQA. To construct
a cross-recurrence plot, two time series are plotted against each other on the
$x$ and $y$ axes. At every point where they share the same state, a point
in placed on the plot to indicate recurrence. (For categorical CRQA, this process
is similar to the Cartesian product.)

We can visually analyze these plots
to reveal patterns of structure and recurrence. The line $y = x$ is known
as the *line of identity*. This line falls where the time series match
temporally. A filled line would indicate perfect in-phase synchrony between the
two time series. See
Figures \@ref(fig:plot-rp-targ-all)-\@ref(fig:plot-rp-source-targ-neg)
for examples of RPs.

#### Metrics
While visual inspections can be informative, we can derive a variety of 
quantitative metrics from the cross-recurrence plot. Each of these metrics
provides information into the patterns and dynamics of the new shared system. 
These metrics are also critical for inferential
statistics. We will focus most directly on two of these metrics: 
*recurrence rate* and *determinism*.

The percentage of recurrent points to total possible points is a metric
called the *recurrence rate* (*RR*). This metrics gives a general description of
how frequently the time series are sharing the same states. In the current
study, a recurrent point would indicate that the level of social cohesion
and frequency of events were at the same intensity.

Recurrent points that occur in successive moments form line structures.
These are conceptualized as shared trajectories, where the two time series
are moving together across time in a shared state. The percentage of
recurrent points on the plot that fall along diagonal line structures 
(i.e., two or more
consecutive points) is a metric called *percent determinism* 
(or simply *determinism*; *DET*). For the
current project, a high DET would indicate that not only are the levels of
social cohesion and frequency of events occurring at similar intensities,
but they are doing so across consecutive days.

A number of other metrics provide insight not only into the amount of structure
between the systems but about the nature of this shared structure.
The average length of the line structures is called *mean line* (L), which can
be conceptualized as the average amount of time that the two time series move
together before one or both shift states. The longest line length is called
*max line* (*maxL*); it indicates the longest instance of being “stuck” in a
particular state together and is a measure of the stability of the system. 
The total *number of lines* on the plot (*NRLINE*) 
scales with structure: The more lines that exist, the more coupled the two 
systems are. The complexity or variability of line lengths is captured by a 
metric called *entropy* (*ENTR*)---which may also be normalized by the total 
number of lines (i.e., *normalized entropy*; *rENTR*)---and indicates
the stability and predictability of the system. When one of the signals gets
“stuck” in a state and the other moves on to other states, this results in
vertical line structures, which are quantified in *laminarity* (*LAM*;
i.e., the proportion of points forming vertical line structures) 
and *trapping time* (*TT*; i.e., the average length of the
vertical trajectories). For more detail on CRQA metrics, see @R-crqa.

#### Parameters
To conduct the analyses on the decile data, the parameters were set to those
typically used in categorical CRQA: Delay was set to $0$, embedding dimension
was set to $1$, and radius was set to $.001$ to allow for only exact recurrent
matches. No normalization was done, and lines were considered two or more
consecutive recurrent points. The Theiler window was set to $0$ to include
points along the line of identity. For more details on the CRQA parameters and
how they impact the analysis, see @R-crqa.

#### Permutation Test
Unlike some nonlinear analyses (e.g., fractal analyses), CRQA metrics do not have
inherently meaningful values. As a result, CRQA is best used as a relative
metric---that is, comparing the CRQA values across conditions or subsets
of the data. Typically, meaningful differences between values are determined with
traditional inferential statistics. While this may not be a problem for 
experimentally derived datasets, it can pose a barrier to researchers using
small-$n$ data or conducting data-informed case studies.

For CRQA, this can be addressed using *permutation tests*.
Similar to more established methods of statistical significance in CRQA research
[which create surrogate time series; e.g., @paxton2017interpersonal],
the permutation test approach to significance testing allows the researcher
to use a time series as its own baseline by testing whether the *structure*
of the unfolding events of the time series---rather than the *raw frequency* of the 
events within the time series---cohere together more than would be expected
by chance. A permutation test is similar to
bootstrapping, except that the sampling of observations is done without
replacement. In this approach, we simply create a large number of permutations
of the original time series (i.e., breaking up the dependency across time points but
preserving the frequencies of the events), conduct CRQA for each of those
permutations, and then examine whether the real time series' CRQA metrics
exceed those that we would expect to see by chance. The proportion of times that
the real time series' values exceeds the surrogate time series' values can
be interpreted as the alpha criterion to determine significance. 
For more information on permutation
tests, see @good2013permutation.

Using the real deciles of social cohesion, count of all events,
count of positive events, and count of negative events, we conducted a series
of permutation tests 
(one for the comparison between social cohesion and each type of event count)
to determine statistical difference from chance for each CRQA metric.
Using the `sample` function in base R [@R-base], $1000$ permuted time series were
created for each of the real time series.  
CRQA was then run $1000$ times for social cohesion and count of all
events, social cohesion and count of positive events, and social cohesion and
count of negative events using the permuted time series. This resulted in
$1000$ results for each of the CRQA metrics for each combination of time series.
Statistical significance from chance was set at the 95th and 99th percentiles
of the metrics from the permuted CRQ analyses. Given that a permutation test
is similar to bootstrapping but does not include replacement, all points were
included in each CRQA analysis, leaving RR constant across all permutations. Thus,
RR is not included in the inferential tests. 

### Windowed Cross-Recurrence Quantification Analysis
We used windowed cross-recurrence quantification analysis
[WCRQA; @webber2005recurrence] to further investigate the evolution of the
temporal dynamics of social cohesion and real-world events. In this analysis,
a smaller “window” of time points is used to calculate CRQA and capture more
fine-grained dynamics of two time series. The window remains the same size and
“slides” diagonally up the line of identity. The changes in the CRQA metrics
across the windows can reveal changes in dynamics that can then be linked to
external, real-world events. 
We implemented WCRQA using the `crqa` package [@R-crqa] for R [@R-base]. 

#### Metrics
Conducting WCRQA results in CRQA metrics (e.g., RR, DET, ENTR) for each
respective window. For these analyses, we decided to focus on recurrence rate 
and determinism.

#### Parameters
In addition to the CRQA parameters, two other parameters are required when
conducting WCRQA. First, the *window size*
will determine how many observations are used in each CRQA analysis. We
conducted WCRQA with a window size of $14$ to investigate the dynamics over
two weeks and allow for the capture of more structure and thus a more
meaningful interpretation of DET. 

The second parameter to be chosen is a *window step size*. 
Window step size is how far the window moves up the line of identity
before conducting CRQA again. We chose $1$ for the step size to understand
how the metrics evolve from day to day. 

All other CRQA metrics remained the same as those previously noted.

#### Visualization
To visualize WCRQA, the resulting metrics from each window can be plotted
as a time series. This allows for visual interpretation of the pattern or
fluctuation of the metrics across time. These dynamics can then be linked
to other external events. See Figures \@ref(fig:plot-wcrqa-targ-all) and
\@ref(fig:plot-wcrqa-source-targ-all) for examples.

#### Permutation Test
To visualize the differences in the WCRQA metrics from those obtained by
chance, a permutation test was done to set upper and lower bounds for the
95th and 99th percentiles. Using a sample size of 14, $1000$ permuted
time series were generated without replacement for each real time series. The
upper and lower 95th and 99th percentiles were set based on the distribution
of the permuted WCRQA metrics.

# Results
```{r primary-crqa, echo=FALSE, warning=FALSE, message=FALSE, error=FALSE, results='hide'}

# run primary crqa analysis
source('./scripts/primary-analyses/02_crqa.R')

# read in metric names
metrics <- t(read.csv("./results/primary/crqa/target-crqa_results-all_events.csv", 
                      header = FALSE)[-2,-1])

# read in metrics from crq analyses (target filtered)
metrics_all_targ <- t(read.csv("./results/primary/crqa/target-crqa_results-all_events.csv", 
                               header = FALSE)[-1,-1])
metrics_pos_targ <- t(read.csv("./results/primary/crqa/target-crqa_results-pos_events.csv", 
                               header = FALSE)[-1,-1])
metrics_neg_targ <- t(read.csv("./results/primary/crqa/target-crqa_results-neg_events.csv", 
                               header = FALSE)[-1,-1])

# read in significance from permutation tests (target filtered)
sig_all_targ <- t(read.csv("./results/primary/crqa/target-metric_signif_all.csv", 
                           header = FALSE)[-1,-1])
sig_pos_targ <- t(read.csv("./results/primary/crqa/target-metric_signif_pos.csv", 
                           header = FALSE)[-1,-1])
sig_neg_targ <- t(read.csv("./results/primary/crqa/target-metric_signif_neg.csv", 
                           header = FALSE)[-1,-1])

# read in metrics from crq analyses (source and target filtered)
metrics_all_source_targ <- t(read.csv("./results/primary/crqa/source_target-crqa_results-all_events.csv",
                                      header = FALSE)[-1,-1])
metrics_pos_source_targ <- t(read.csv("./results/primary/crqa/source_target-crqa_results-pos_events.csv",
                                      header = FALSE)[-1,-1])
metrics_neg_source_targ <- t(read.csv("./results/primary/crqa/source_target-crqa_results-neg_events.csv",
                                      header = FALSE)[-1,-1])

# read in significance from permutation tests (source and target filtered)
sig_all_source_targ <- t(read.csv("./results/primary/crqa/source_target-metric_signif_all.csv", 
                                  header = FALSE)[-1,-1])
sig_pos_source_targ <- t(read.csv("./results/primary/crqa/source_target-metric_signif_pos.csv", 
                                  header = FALSE)[-1,-1])
sig_neg_source_targ <- t(read.csv("./results/primary/crqa/source_target-metric_signif_neg.csv", 
                                  header = FALSE)[-1,-1])

```

```{r raw-ts, echo=FALSE, warning=FALSE, message=FALSE, error=FALSE, fig.cap = 'Example of pre-processed data.'}

# read in processed data
data <- read.csv("./data/formatted/primary/formatted_data.csv", header = TRUE)

raw_ts_example <- ggplot(data, aes(x= as.Date(Date), y=all_events_target)) +
  geom_point() +
  geom_line() +
  xlab("Date") +
  ylab("Count of events")
ggsave("./results/primary/tally_ts_example.png")

# call the image
knitr::include_graphics("./results/primary/tally_ts_example.png")

```

```{r deciled-ts, echo=FALSE, warning=FALSE, message=FALSE, error=FALSE, fig.cap = 'Example of deciled data.'}

# plot the deciles time series and save
deciled_ts_example <- ggplot(data, aes(x= as.Date(Date), y=all_deciles_target)) +
  geom_point() +
  geom_line() +
  xlab("Date") +
  ylab("Count of events (deciles)")
ggsave("./results/primary/deciled_ts_example.png")

# call the image
knitr::include_graphics("./results/primary/deciled_ts_example.png")

```

## Cross-Recurrence Quantification Analysis

### Syria as Target

A permutation test for the CRQA of social cohesion and count of all events 
found a statistical difference from chance for DET, NRLINE, maxL, and LAM. 
All other metrics did not reach significance (Figure \@ref(fig:plot-rp-targ-all);
\autoref{table-1}). 

A permutation test for the CRQA of social cohesion and 
count of positive events found no statistically significant difference for any 
of the metrics other than TT (Figure \@ref(fig:plot-rp-targ-pos); 
\autoref{table-1}). 

A permutation test for the CRQA of social cohesion and 
count of negative events found a statistically significant difference for DET, 
NRLINE, L, ENTR, LAM, and TT. All other metrics did not reach significance 
(Figure \@ref(fig:plot-rp-targ-neg); \autoref{table-1}). 

A qualitative investigation of the recurrence plots suggests
a shift in dynamics around the 36th observation, 
which corresponds to May 4th, 2012.

```{r primary-crqa-table-target, echo=FALSE, warning=FALSE, message=FALSE, error=FALSE}

# bind metrics and significance results
target_results <- as.data.frame(cbind(metrics,
                                      metrics_all_targ,
                                      sig_all_targ,
                                      metrics_pos_targ,
                                      sig_pos_targ,
                                      metrics_neg_targ,
                                      sig_neg_targ), stringsAsFactors = FALSE)

# covert to numerics for rounding
numerics <- c(2:7)
target_results[,numerics] <- sapply(target_results[,numerics],as.numeric)

# add significance stars
stars_all <- as.data.frame(stars.pval(target_results[,3]))
stars_pos <- as.data.frame(stars.pval(target_results[,5]))
stars_neg <- as.data.frame(stars.pval(target_results[,7]))

target_results <- cbind(target_results, stars_all, stars_pos, stars_neg)
target_results <- target_results[,c(1,2,3,8,4,5,9,6,7,10)]

# give intuitive names
colnames(target_results) <- c("metric", 
                              "all events", "p", "sig.", 
                              "positive events", "p", "sig.", 
                              "negative events", "p", "sig.")

# exclude row names
rownames(target_results) <- NULL

# set to not split table and round to two decimal places
panderOptions("table.split.table", Inf)
panderOptions('round', 3)
panderOptions('keep.trailing.zeros', TRUE)

# style for Rmd
panderOptions("table.style", "rmarkdown")

# build table
pander(target_results, caption = "\\label{table-1}CRQA results for target only data.")

```

```{r plot-rp-targ-all, echo=FALSE, warning=FALSE, message=FALSE, error=FALSE, fig.cap = 'Recurrence plot (RP) for social cohesion and count of all events from target filtered data.'}

# call image
knitr::include_graphics("./results/primary/crqa/target-rp-all_events.png")

```

```{r plot-rp-targ-pos, echo=FALSE, warning=FALSE, message=FALSE, error=FALSE, fig.cap = 'Recurrence plot (RP) for social cohesion and count of positive events from target filtered data.'}

# call image
knitr::include_graphics("./results/primary/crqa/target-rp-pos_events.png")

```

```{r plot-rp-targ-neg, echo=FALSE, warning=FALSE, message=FALSE, error=FALSE, fig.cap = 'Recurrence plot (RP) for social cohesion and count of negative events from target filtered data.'}

# call image
knitr::include_graphics("./results/primary/crqa/target-rp-neg_events.png")

```

### Syria as Source and Target
A permutation test for the CRQA of social cohesion and count of all 
events found a statistical difference from chance for DET, NRLINE, and 
LAM. All other metrics were non-significant (Figure 
\@ref(fig:plot-rp-source-targ-all); \autoref{table-2}). 

A permutation test for the CRQA of social cohesion and count of positive 
events found a statistical difference from chance for maxL, ENTR, and LAM 
(Figure \@ref(fig:plot-rp-source-targ-pos); \autoref{table-2}). 

A permutation test for the CRQA of social cohesion and count of negative 
events found a statistical difference from chance for DET, NRLINE, and rENTR. 
All other metrics were non-significant (Figure 
\@ref(fig:plot-rp-source-targ-neg); \autoref{table-2}). 

Looking qualitatively at the recurrence plots, there again appeared 
to be a shift in dynamics around the 36th observation (May 4th, 2012).

```{r primary-table-source-target, echo=FALSE, warning=FALSE, message=FALSE, error=FALSE}

# bind metrics and significance results
source_target_results <- as.data.frame(cbind(metrics,
                                      metrics_all_source_targ,
                                      sig_all_source_targ,
                                      metrics_pos_source_targ,
                                      sig_pos_source_targ,
                                      metrics_neg_source_targ,
                                      sig_neg_source_targ), stringsAsFactors = FALSE)

# covert to numerics for rounding
numerics <- c(2:7)
source_target_results[,numerics] <- sapply(source_target_results[,numerics],as.numeric)

# add significance stars
stars_all <- as.data.frame(stars.pval(source_target_results[,3]))
stars_pos <- as.data.frame(stars.pval(source_target_results[,5]))
stars_neg <- as.data.frame(stars.pval(source_target_results[,7]))

source_target_results <- cbind(source_target_results, stars_all, stars_pos, stars_neg)
source_target_results <- source_target_results[,c(1,2,3,8,4,5,9,6,7,10)]

# give intuitive names
colnames(source_target_results) <- c("metric", 
                                     "all events", "p", "sig.", 
                                     "positive events", "p", "sig.", 
                                     "negative events", "p", "sig.")

# exclude row names
rownames(source_target_results) <- NULL

# set to not split table and round to two decimal places
panderOptions("table.split.table", Inf)
panderOptions('round', 3)
panderOptions('keep.trailing.zeros', TRUE)

# style for Rmd
panderOptions("table.style", "rmarkdown")

# build table
pander(source_target_results, caption = "\\label{table-2}CRQA results for source and target data.")

```

```{r plot-rp-source-targ-all, echo=FALSE, warning=FALSE, message=FALSE, error=FALSE, fig.cap = 'Recurrence plot (RP) for social cohesion and count of all events from source and target filtered data.'}

# call image
knitr::include_graphics("./results/primary/crqa/source_target-rp-all_events.png")

```

```{r plot-rp-source-targ-pos, echo=FALSE, warning=FALSE, message=FALSE, error=FALSE, fig.cap = 'Recurrence plot (RP) for social cohesion and count of positive events from source and target filtered data.'}

# call image
knitr::include_graphics("./results/primary/crqa/source_target-rp-pos_events.png")

```

```{r plot-rp-source-targ-neg, echo=FALSE, warning=FALSE, message=FALSE, error=FALSE, fig.cap = 'Recurrence plot (RP) for social cohesion and count of negative events from source and target filtered data.'}

# call image
knitr::include_graphics("./results/primary/crqa/source_target-rp-neg_events.png")

```

## Windowed Cross-Recurrence Quantification Analysis
```{r primary-wcrqa, echo=FALSE, warning=FALSE, message=FALSE, error=FALSE, results='hide', include = FALSE}

# run primary crq analysis
source('./scripts/primary-analyses/03_windowed_crqa.R')

```

In the plots (see Figures \@ref(fig:plot-wcrqa-targ-all) and 
\@ref(fig:plot-wcrqa-source-targ-all)), the 95th percentiles are represented
by horizontal red lines, and the 99th percentiles are
represented by horizontal orange lines. The trend lines are plotted in blue.

### Syria as Target

```{r plot-wcrqa-targ-all, echo=FALSE, warning=FALSE, message=FALSE, error=FALSE, fig.cap = 'Windowed CRQA for social cohesion and event counts from target filtered data.', out.extra='angle=90'}

# call image
knitr::include_graphics("./results/primary/windowed-crqa/target-windowed_all.png")

```

```{r plot-mode-event, echo=FALSE, warning=FALSE, message=FALSE, error=FALSE, fig.cap = 'Mode ICEWS event per day.'}

mode_plot <- ggplot(data, aes(x= as.Date(Date), y=mode_source_target)) +
                    geom_point() +
                    geom_line() +
                    xlab("Date") +
                    ylab("Mode ICEWS event")
ggsave("./results/primary/mode_ts_plot.png")

# call the image
knitr::include_graphics("./results/primary/mode_ts_plot.png")

```

For social cohesion and count of all events, there was a consistent period 
of above-chance RR from the 7th-12th and 36th-47th window. DET was largely 
above chance from the 46th to the 61st window 
(Figure \@ref(fig:plot-wcrqa-targ-all)). 

For social cohesion and count of positive events, there was a downward trend in RR 
as the window moves with largely above-chance RR from the 1st-18th and 
32nd-45th windows. DET was at or above chance for the 8th-17th, 
32nd-34th and at the 60th window (Figure \@ref(fig:plot-wcrqa-targ-all)). 

For social cohesion and count of negative events, RR stayed above
or almost above chance from the 4th-7th and 43rd-47th windows. DET
was above or nearly above chance in the 1st and 2nd windows, with intermittent 
peaks in later windows (Figure \@ref(fig:plot-wcrqa-targ-all)).

### Syria as Source and Target

```{r plot-wcrqa-source-targ-all, echo=FALSE, warning=FALSE, message=FALSE, error=FALSE, fig.cap = 'Windowed CRQA for social cohesion and event counts from source and target filtered data.', out.extra='angle=90'}

# call image
knitr::include_graphics("./results/primary/windowed-crqa/source_target-windowed_all.png")

```

For social cohesion and count of all events, there was a consistent period of
above- or nearly above-chance DET from the 7th-13th and 26th-47th 
windows. DET also showed above- or nearly above-chance values in windows 7 
through 17 and intermittent peaks between the 34th and 61st windows 
(Figure \@ref(fig:plot-wcrqa-source-targ-all)). 

For social cohesion and count of 
positive events, there was a downward trend in RR as the window moved, with 
largely above-chance values in the first 20 windows and the 32nd-45th windows. 
DET stayed largely within chance, with the exception of windows 13 
through 19 (Figure \@ref(fig:plot-wcrqa-source-targ-all)). 

For social cohesion
and negative events, there was an extended period of time during which RR 
(32nd-47th windows) and DET (35th-39th windows) were above or nearly above 
chance (Figure \@ref(fig:plot-wcrqa-source-targ-all)). These windows span from
May 3rd--14th, 2012.

# Discussion
In the present study, we investigated the dynamics of real-world events
and online communication on Twitter in Syria during Arab Spring. 
CRQA methodology allows us to model the relationship between sociolinguistic 
cohesion and exogenous political events. This work stands alongside the model 
of Palestinian-Israeli social media and events developed by Zeitzoff (2011), 
and the role of peripheral participants in the Syrian Arab Spring movement by 
Steinert-Threlkeld (2017). By introducing the CRQA and WCRQA methods, we 
demonstrate how language and social mobilization interact with events along 
the conflict-cooperation continuum in Syria. We have introduced a novel 
theoretical framework of sociolinguistic cohesion which we operationalize 
using a weighted measure of lexical relationships. We examined
how social mobilization both virtually and physically evolve over time in
tandem. Using nonlinear dynamical time series analyses, we investigated the 
theory that virtual mobilization is increasingly reflective of real-world 
events during times of strife.

## Cross-Recurrence Quantification Analysis
### Syria as Target
The significant result of DET for social cohesion with all and negative 
events supports our hypothesis that event salience is coupled with online 
social cohesion. The frequency of all and negative events are thus associated 
with greater shared trajectories with social cohesion that would be expected 
by chance. However, when we specifically target positive events, the connection
to social cohesion fades, providing further support for our hypothesis. 
Positive events may be less coupled to social cohesion than more salient 
negative events during times of turmoil; by contrast, overall event frequency 
and negative event frequency are coupled with Twitter social cohesion.

### Syria as Source and Target
By adding Syria as a source in the data filtering, the dataset increased
in size by 1,690 samples. These additional observations are times where
Syria initiated an event with another country. Events initiated by Syria
but directed internally within the country were already captured by the
target-only filtering. The increase in coupling between positive events
and social cohesion can thus only be due to the externally
directed events. Though the coupling between social cohesion with
negative and all events were largely unchanged, 
positive events and social cohesion showed greater stability
in their coupling (reflected in maxL); while TT was no longer
significant in these analyses, LAM (related to TT) did
reach statistical significance.

While interesting, the underlying meaning or drivers of this change
in results requires further investigation that incorporates the
actual content of the tweets themselves. One possible reason (among
many) may be that the finding was spurious. The positive external 
events from Syria may have been self-serving, aiming to prevent intervention
by other countries or to cover up what was happening internally.
During these moments, the increased cohesion may reflect a surge from 
the Syrian people trying to raise awareness of the situation or
to decry the Syrian government's attempts to improve their international
standing. In this case, the increased coupling of positive events would
be coupled not with shared positive affect in social media but instead
to shared negative affect in social media in response. However, we
cannot test this hypothesis with the current data; future 
research should explore the semantic content of this tweet
corpus to determine the nature of the socially cohered language.

## Windowed-Recurrence Quantification Analysis

### Syria as Target
The time period of differing dynamics---from observation 38 through 
43---appears to be captured by the RR and DET values in
WCRQA of social cohesion and count of negative
events (Figure \@ref(fig:plot-wcrqa-targ-all)). The
amount of recurrence and determinism for these periods almost consistently
lie above chance, suggesting that the intensity of negative events coincide
with the degree of social cohesion found on Twitter and that these 
shared trajectories extend across multiple days.

The above-chance levels of determinism and recurrence rate demonstrate
the coupling of social cohesion to both total and negative events during
times of strife. During this period, 
the modal ICEWS event for each day (Figure \@ref(fig:plot-mode-event))
during May 1st---15th was almost consistently -10, the most violent 
event category. These dates directly correlate with the above-chance RR and DET
metrics for the WCRQA of social cohesion and count of negative events.
Furthermore, for WCRQA of social cohesion and positive event count during
this time period, DET was entirely within chance (Figure
\@ref(fig:plot-wcrqa-targ-all)). This supports our hypothesis, as the
positive events are seemingly not coupled with the social cohesion on Twitter
during civil uprisings during the Arab Spring.

### Syria as Source and Target
WCRQA of recurrence rate on the source and target filtered data remained
largely the same for count of all events and social cohesion, suggesting
that large numbers on a given day will be reflective of increased levels
of social cohesion. DET showed more frequent above-chance metrics
for windows 39 and up, suggesting that the inclusion of externally
directed events lead to higher event counts during these days and then
was more reflective of the level of social cohesion on Twitter. 

WCRQA metrics for positive-only and negative-only event counts with 
social cohesion remained largely the same for
RR and DET as the source-only data. This may support the ideas suggested
in the CRQA section, but again, only future work including the *content*
of those tweets can directly speak to that explanation.

## Implications

### Implications for Methodology

Nonlinear methods have been transformative for a variety of research
areas [including psychology, @coco2014cross]. One of the goals in the
present work was to introduce variants of one kind of nonlinear
method---specifically, recurrence quantification analysis---to
this research area. While a number of excellent guides can provide
detailed explanations of the methods and their statistical underpinnings 
[e.g., @riley2005tutorials; @webber1994dynamical; @webber2005recurrence],
one of the most important considerations that should be briefly
summarized here is about data.

Nonlinear methods---including recurrence-based analyses---require
time series data. This requires repeated observations of the behavior
at interest, preferably at a frequency that provides information 
about timing at a temporal resolution that allows the researcher to 
make observations about interesting variations over time. While
this is easily controlled by scientists who conduct experimental
research, it can be more difficult for scientists who rely on
trace data or naturally occurring data. However, where possible,
we recommend political scientists work to expand efforts for
improving the temporal granularity of the data. One possible
means of achieving this may be through collaborative efforts
like the Open Event Data Alliance [@schrodt2014three].

### Implications for Theory

This methodology should be of great interest to social scientists investigating social mobilization. It has potential applications for gender studies and the #MeToo movement, and for the relationship between social protest and repression during the Black Lives Matter protests. Fundamentally, this methodological approach can help us better understand the mechanisms underlying social media, and its influence on human behavior in real life. Given that many governments enact repressive measures when they determine that collective action by citizens has become an imminent possibility this methodology should help to improve the predictive power of using social media data in estimating repressive behavior. If social media messages are increasing in cohesion, this may represent a threat to civil and political liberties of citizens engaging in collective action. 

## Conclusion
Considering the pervasiveness of social media, it is unsurprising
that social activists and protesters have
utilized these platforms to support real-world mobilization. 
Here, we quantitatively explored the connection
between online social cohesion and real-world events. In addition
to introducing political scientists to a family of powerful nonlinear 
dynamics analyses, our results have serious implications for monitoring global
movements in consistent across other social uprisings. While traditional, 
state-run media in regions of authoritarian rule are often biased and 
propaganda for the leader and central government, the 
self-organized nature of Twitter poses a new avenue to gain insight into 
truths about up-risings and social mobilization. By conceptualizing Twitter 
and real-world events as two elements of an inextricably linked dynamical 
system, the levels of social cohesion within social media platforms could be 
monitored for fluctuations indicating shifts in power and peace. Social media
mobilization may thus help alert the world to citizens' actions and reactions 
that are suppressed by government regimes, providing insight into events that 
may not otherwise be broadcast and allowing for faster intervention.

### Acknowledgements

\newpage

# References

\begingroup
\setlength{\parindent}{-0.5in}
\setlength{\leftskip}{0.5in}

<div id="refs" custom-style="Bibliography"></div>
\endgroup
